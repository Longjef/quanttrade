import{d as b,aC as y,i as u,c as D,a as z,h as g,j as p,k as x,b as O,w as G,Z as N,W as M,o as _,Y as V,g as C,B as j}from"./index-3d1c2723.js";import{u as T,aI as v,aE as k,aF as w,aG as P,aH as $,aJ as L}from"./install-419c7b94.js";import{j as A,e as I,l as S,k as R,g as F,h as H}from"./chartZoom-61c7f12b.js";function Z(n,a){const i=Math.min(...n),d=(Math.max(...n)-i)*1.01/a,r=[...Array(a).keys()].map(t=>[Math.round((i+t*d)*1e3)/1e3,0]);for(let t=0;t<n.length;t++){const e=Math.min(Math.floor((n[t]-i)/d),a-1);isNaN(e)||r[e][1]++}return r}const q={class:"d-flex flex-column h-100 position-relative"},E={class:"flex-grow-1 order-2"},f="Trade count",U=b({__name:"ProfitDistributionChart",props:{trades:{required:!0,type:Array},showTitle:{default:!0,type:Boolean}},setup(n){const a=n;T([A,v,k,I,w,P,$]);const i=y(),m=[10,15,20,25,50],d=u(()=>{const t=a.trades.map(e=>e.profit_ratio);return Z(t,i.profitDistributionBins)}),r=u(()=>({title:{text:"Profit distribution",show:a.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{source:d.value},tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},legend:{data:[f],right:"5%"},xAxis:{type:"category",name:"Profit %",nameLocation:"middle",nameGap:25},yAxis:[{type:"value",name:f,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:35,position:"left"}],series:[{type:"bar",name:f,animation:!0,encode:{x:"x0",y:"y0"}}]}));return(t,e)=>{const l=V,s=M;return _(),D("div",q,[z("div",E,[n.trades?(_(),g(p(L),{key:0,option:r.value,autoresize:"",theme:p(i).chartTheme},null,8,["option","theme"])):x("",!0)]),O(s,{class:N(["w-25 order-1",n.showTitle?"ms-5 ps-5":"position-absolute"]),label:"Bins","label-for":"input-bins","label-cols":"6","content-cols":"6",size:"sm"},{default:G(()=>[O(l,{id:"input-bins",modelValue:p(i).profitDistributionBins,"onUpdate:modelValue":e[0]||(e[0]=c=>p(i).profitDistributionBins=c),size:"sm",options:m},null,8,["modelValue"])]),_:1},8,["class"])])}}});const tt=C(U,[["__scopeId","data-v-10b59a61"]]),h="Profit",W=b({__name:"CumProfitChart",props:{trades:{required:!0,type:Array},showTitle:{default:!0,type:Boolean},profitColumn:{default:"profit_abs",type:String}},setup(n){const a=n;T([A,R,v,k,I,w,P,$]);const i=y(),m=u(()=>{const r=[],t={},e=a.trades.slice().sort((s,c)=>s.close_timestamp>c.close_timestamp?1:-1);let l=0;for(let s=0,c=e.length;s<c;s+=1){const o=e[s];o.close_timestamp&&o[a.profitColumn]&&(l+=o[a.profitColumn],t[o.close_timestamp]?(t[o.close_timestamp].profit+=o[a.profitColumn],t[o.close_timestamp][o.botId]?t[o.close_timestamp][o.botId]+=o[a.profitColumn]:t[o.close_timestamp][o.botId]=l):t[o.close_timestamp]={profit:l,[o.botId]:l},r.push({date:o.close_timestamp,profit:l,[o.botId]:l}))}return Object.entries(t).map(([s,c])=>({date:parseInt(s,10),profit:c.profit}))}),d=u(()=>({title:{text:"Cumulative Profit",show:a.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{dimensions:["date","profit"],source:m.value},tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},legend:{data:[h],right:"5%"},useUTC:!1,xAxis:{type:"time"},yAxis:[{type:"value",name:h,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:40}],grid:{bottom:80},dataZoom:[{type:"inside",start:0,end:100},{bottom:10,start:0,end:100,...S}],series:[{type:"line",name:h,animation:!0,step:"end",lineStyle:{color:i.chartTheme==="dark"?"#c2c2c2":"black"},itemStyle:{color:i.chartTheme==="dark"?"#c2c2c2":"black"}}]}));return(r,t)=>n.trades?(_(),g(p(L),{key:0,option:d.value,autoresize:"",theme:p(i).chartTheme},null,8,["option","theme"])):x("",!0)}});const et=C(W,[["__scopeId","data-v-374b3af0"]]),B="Profit %",J="#9be0a8",Y=b({__name:"TradesLog",props:{trades:{required:!0,type:Array},showTitle:{default:!0,type:Boolean}},setup(n){const a=n;T([A,R,v,k,I,w,P,$,F,H]);const i=y(),m=u(()=>{const r=[],t=a.trades.slice(0).sort((e,l)=>e.close_timestamp>l.close_timestamp?1:-1);for(let e=0,l=t.length;e<l;e+=1){const s=t[e],c=[e,(s.profit_ratio*100).toFixed(2),s.pair,s.botName,j(s.close_timestamp),s.is_short===void 0||!s.is_short?"Long":"Short"];r.push(c)}return r}),d=u(()=>{const r=m.value.length>0?(1-50/m.value.length)*100:100;return{title:{text:"Trades log",show:a.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{dimensions:["date","profit"],source:m.value},tooltip:{trigger:"axis",formatter:t=>{const e=t[0].data[3]?` | ${t[0].data[3]}`:"";return`${t[0].data[2]} | ${t[0].data[5]} ${e}<br>${t[0].data[4]}<br>Profit ${t[0].data[1]} %`},axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},xAxis:{type:"value",show:!1},yAxis:[{type:"value",name:B,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:30}],grid:{bottom:80},dataZoom:[{type:"inside",start:r,end:100},{bottom:10,start:r,end:100,...S}],visualMap:[{show:!0,seriesIndex:0,pieces:[{max:0,color:"#f84960"},{min:0,color:"#2ed191"}]}],series:[{type:"bar",name:B,barGap:"0%",barCategoryGap:"0%",animation:!1,label:{show:!0,position:"top",rotate:90,offset:[7.5,7.5],formatter:"{@[1]} %",color:i.chartTheme==="dark"?"#c2c2c2":"#3c3c3c"},encode:{x:0,y:1},itemStyle:{color:J}}]}});return(r,t)=>n.trades.length>0?(_(),g(p(L),{key:0,option:d.value,autoresize:"",theme:p(i).chartTheme},null,8,["option","theme"])):x("",!0)}});const ot=C(Y,[["__scopeId","data-v-dd80fb73"]]);export{et as C,tt as P,ot as T};
//# sourceMappingURL=TradesLog-c1067f34.js.map
